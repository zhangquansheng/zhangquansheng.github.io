(window.webpackJsonp=window.webpackJsonp||[]).push([[145],{414:function(s,a,t){"use strict";t.r(a);var n=t(10),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"部门工资最高的员工"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#部门工资最高的员工"}},[s._v("#")]),s._v(" 部门工资最高的员工")]),s._v(" "),a("ul",[a("li",[s._v("来源：力扣（LeetCode）")]),s._v(" "),a("li",[s._v("链接：https://leetcode-cn.com/problems/department-highest-salary")]),s._v(" "),a("li",[s._v("著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。")])]),s._v(" "),a("p",[a("code",[s._v("Employee")]),s._v(" 表包含所有员工信息，每个员工有其对应的 "),a("code",[s._v("Id")]),s._v(", "),a("code",[s._v("salary")]),s._v(" 和 "),a("code",[s._v("departmentId")]),s._v("。")]),s._v(" "),a("div",{staticClass:"language-markdown line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-markdown"}},[a("code",[s._v("+----+-------+--------+--------------+\n| Id | Name  | Salary | DepartmentId |\n+----+-------+--------+--------------+\n| 1  | Joe   | 70000  | 1            |\n| 2  | Jim   | 90000  | 1            |\n| 3  | Henry | 80000  | 2            |\n| 4  | Sam   | 60000  | 2            |\n| 5  | Max   | 90000  | 1            |\n+----+-------+--------+--------------+\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[a("code",[s._v("Department")]),s._v(" 表包含公司所有部门的信息。")]),s._v(" "),a("div",{staticClass:"language-markdown line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-markdown"}},[a("code",[s._v("+----+----------+\n| Id | Name     |\n+----+----------+\n| 1  | IT       |\n| 2  | Sales    |\n+----+----------+\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("编写一个 "),a("code",[s._v("SQL")]),s._v(" 查询，找出每个部门工资最高的员工。对于上述表，您的 "),a("code",[s._v("SQL")]),s._v(" 查询应返回以下行（行的顺序无关紧要）。")]),s._v(" "),a("div",{staticClass:"language-markdown line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-markdown"}},[a("code",[s._v("+------------+----------+--------+\n| Department | Employee | Salary |\n+------------+----------+--------+\n| IT         | Max      | 90000  |\n| IT         | Jim      | 90000  |\n| Sales      | Henry    | 80000  |\n+------------+----------+--------+\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("解释：")]),s._v(" "),a("p",[a("code",[s._v("Max")]),s._v(" 和 "),a("code",[s._v("Jim")]),s._v(" 在 "),a("code",[s._v("IT")]),s._v(" 部门的工资都是最高的，"),a("code",[s._v("Henry")]),s._v(" 在销售部的工资最高。")]),s._v(" "),a("h2",{attrs:{id:"mysql-8-0-窗口函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mysql-8-0-窗口函数"}},[s._v("#")]),s._v(" MySQL 8.0 窗口函数")]),s._v(" "),a("p",[s._v("在"),a("code",[s._v("SQL")]),s._v("中我们经常遇到一种需求："),a("strong",[s._v("分组排序")]),s._v("，"),a("strong",[s._v("分组求和")]),s._v("等需求。要解决此类问题，最方便的就是使用窗口函数。")]),s._v(" "),a("p",[a("code",[s._v("MySQL")]),s._v("从"),a("code",[s._v("8.0")]),s._v("开始支持窗口函数，这个功能在大多商业数据库和部分开源数据库中早已支持，有的也叫"),a("strong",[s._v("分析函数")]),s._v("。")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("什么叫窗口?")]),s._v(" "),a("p",[s._v("窗口的概念非常重要，它可以理解为记录集合，窗口函数也就是在满足某种条件的记录集合上执行的特殊函数。\n对于每条记录都要在此窗口内执行函数，有的函数随着记录不同，窗口大小都是固定的，这种属于静态窗口；\n有的函数则相反，不同的记录对应着不同的窗口，这种动态变化的窗口叫滑动窗口。")])]),s._v(" "),a("p",[s._v("窗口函数和普通聚合函数也很容易混淆，二者区别如下：")]),s._v(" "),a("ul",[a("li",[s._v("聚合函数是将多条记录聚合为一条；而窗口函数是每条记录都会执行，有几条记录执行完还是几条；")]),s._v(" "),a("li",[s._v("聚合函数也可以用于窗口函数中；")])]),s._v(" "),a("p",[s._v("按照功能划分，可以把"),a("code",[s._v("MySQL")]),s._v("支持的窗口函数分为如下几类：")]),s._v(" "),a("ul",[a("li",[s._v("序号函数："),a("code",[s._v("row_number()")]),s._v(" / "),a("code",[s._v("rank()")]),s._v(" / "),a("code",[s._v("dense_rank()")])]),s._v(" "),a("li",[s._v("分布函数："),a("code",[s._v("percent_rank()")]),s._v(" / "),a("code",[s._v("cume_dist()")])]),s._v(" "),a("li",[s._v("前后函数："),a("code",[s._v("lag()")]),s._v(" / "),a("code",[s._v("lead()")])]),s._v(" "),a("li",[s._v("头尾函数："),a("code",[s._v("first_val()")]),s._v(" / "),a("code",[s._v("last_val()")])]),s._v(" "),a("li",[s._v("其他函数："),a("code",[s._v("nth_value()")]),s._v(" / "),a("code",[s._v("nfile()")])])]),s._v(" "),a("p",[s._v("序号函数的一般语法如下：")]),s._v(" "),a("blockquote",[a("p",[s._v("select 序号函数 over (partition by 用于分组的列名 order by 用于排序的列名)")])]),s._v(" "),a("p",[s._v("其中，"),a("code",[s._v("over")]),s._v("是关键字，用来指定函数执行的窗口范围。")]),s._v(" "),a("p",[s._v("那么题解"),a("code",[s._v("SQL")]),s._v("如下：")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" Department"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Employee"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Salary\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" \n    D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Name "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" Department"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n    E"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Name "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" Employee"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n    E"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Salary "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" Salary"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n    rank"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("over")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("partition")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v(" D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Name "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("order")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v(" E"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Salary "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("desc")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" rank_\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" Employee E "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("join")]),s._v(" Department D "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" E"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("DepartmentId "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Id\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" tmp\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" rank_ "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("h2",{attrs:{id:"mysql-5-6-5-7-题解"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mysql-5-6-5-7-题解"}},[s._v("#")]),s._v(" MySQL 5.6/5.7 题解")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v("\n    Department"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("name "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Department'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    Employee"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("name "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Employee'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    Salary\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v("\n    Employee\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("JOIN")]),s._v("\n    Department "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" Employee"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("DepartmentId "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Department"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Id\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Employee"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("DepartmentId "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Salary"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("IN")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v("\n            DepartmentId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("MAX")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Salary"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v("\n            Employee\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GROUP")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" DepartmentId\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("p",[s._v("平时的"),a("code",[s._v("IN")]),s._v("都是一个字段的，其实也可以使用两个字段"),a("code",[s._v("IN")]),s._v("的，这是本题解的最大亮点。")]),s._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[s._v("WARNING")]),s._v(" "),a("p",[s._v("多字段"),a("code",[s._v("IN")]),s._v("的，一般的都会索引失效，平常少用！")])]),s._v(" "),a("hr"),s._v(" "),a("p",[a("strong",[s._v("参考文档")])]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.cnblogs.com/DataArt/p/9961676.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("MySQL 8.0窗口函数"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=e.exports}}]);