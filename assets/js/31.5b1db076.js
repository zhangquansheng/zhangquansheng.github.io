(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{308:function(t,a,e){"use strict";e.r(a);var s=e(10),n=Object(s.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"aqs-æŠ½è±¡é˜Ÿåˆ—åŒæ­¥å™¨"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#aqs-æŠ½è±¡é˜Ÿåˆ—åŒæ­¥å™¨"}},[t._v("#")]),t._v(" AQS æŠ½è±¡é˜Ÿåˆ—åŒæ­¥å™¨ ğŸ”¨")]),t._v(" "),a("p",[t._v("AQS çš„å…¨ç§°ä¸ºï¼ˆAbstractQueuedSynchronizerï¼‰ï¼Œè¿™ä¸ªç±»åœ¨java.util.concurrent.locksåŒ…ä¸‹é¢ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/concurrent/AQS.awebp",alt:"AQS.awebp"}})]),t._v(" "),a("h2",{attrs:{id:"åŸºæœ¬å±æ€§-state-åŒå‘é˜Ÿåˆ—"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åŸºæœ¬å±æ€§-state-åŒå‘é˜Ÿåˆ—"}},[t._v("#")]),t._v(" åŸºæœ¬å±æ€§ï¼šstate åŒå‘é˜Ÿåˆ—")]),t._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//å¤´èŠ‚ç‚¹")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("transient")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("volatile")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Node")]),t._v(" head"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//å°¾èŠ‚ç‚¹")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("transient")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("volatile")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Node")]),t._v(" tail"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//çŠ¶æ€å€¼")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("volatile")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br")])]),a("p",[t._v("AQSçš„å®ç°ä¾èµ–å†…éƒ¨çš„åŒæ­¥é˜Ÿåˆ—ï¼Œä¹Ÿå°±æ˜¯FIFOçš„åŒå‘é˜Ÿåˆ—ï¼ˆåŒå‘é“¾è¡¨ï¼‰ï¼Œå¦‚æœå½“å‰çº¿ç¨‹ç«äº‰é”å¤±è´¥ï¼Œ\né‚£ä¹ˆAQSä¼šæŠŠå½“å‰çº¿ç¨‹ä»¥åŠç­‰å¾…çŠ¶æ€ä¿¡æ¯æ„é€ æˆä¸€ä¸ªNodeåŠ å…¥åˆ°åŒæ­¥é˜Ÿåˆ—ä¸­ï¼ŒåŒæ—¶å†é˜»å¡è¯¥çº¿ç¨‹ã€‚\nå½“è·å–é”çš„çº¿ç¨‹é‡Šæ”¾é”ä»¥åï¼Œä¼šä»é˜Ÿåˆ—ä¸­å”¤é†’ä¸€ä¸ªé˜»å¡çš„èŠ‚ç‚¹(çº¿ç¨‹)ã€‚")]),t._v(" "),a("h2",{attrs:{id:"ç‹¬å é”-ã€-å…±äº«é”"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç‹¬å é”-ã€-å…±äº«é”"}},[t._v("#")]),t._v(" ç‹¬å é” ã€ å…±äº«é”")]),t._v(" "),a("ol",[a("li",[t._v("ç‹¬å é” ï¼š åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æ‹¿åˆ°é”æ‰§è¡Œï¼Œé”çš„çŠ¶æ€åªæœ‰0å’Œ1ä¸¤ç§æƒ…å†µ\n"),a("ul",[a("li",[t._v("ReentrantLock")])])]),t._v(" "),a("li",[t._v("å…±äº«é” ï¼š åŒä¸€æ—¶é—´æœ‰å¤šä¸ªçº¿ç¨‹å¯ä»¥æ‹¿åˆ°é”ååŒå·¥ä½œï¼Œé”çš„çŠ¶æ€å¤§äºæˆ–ç­‰äº0\n"),a("ul",[a("li",[t._v("CountDownLatch")])])])]),t._v(" "),a("h2",{attrs:{id:"ä¸ºä»€ä¹ˆè¦ç”¨åŒå‘é“¾è¡¨"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¸ºä»€ä¹ˆè¦ç”¨åŒå‘é“¾è¡¨"}},[t._v("#")]),t._v(" ä¸ºä»€ä¹ˆè¦ç”¨åŒå‘é“¾è¡¨")]),t._v(" "),a("ol",[a("li",[t._v("å› ä¸ºå¤„äºé”é˜»å¡çš„çº¿ç¨‹å…è®¸è¢«ä¸­æ–­ï¼Œè¢«ä¸­æ–­çš„çº¿ç¨‹æ˜¯ä¸éœ€è¦å»ç«äº‰é”çš„ï¼Œä½†æ˜¯å®ƒä»ç„¶å­˜åœ¨äºåŒå‘é“¾è¡¨é‡Œé¢ã€‚\nåœ¨åç»­çš„é”ç«äº‰ä¸­ï¼Œéœ€è¦æŠŠè¿™ä¸ªèŠ‚ç‚¹ä»é“¾è¡¨é‡Œé¢ç§»é™¤ï¼Œå¦‚æœæ˜¯å•å‘åˆ—è¡¨ï¼Œå°±éœ€è¦ä»headèŠ‚ç‚¹å¼€å§‹å¾€ä¸‹é€ä¸ªä¾¿åˆ©ï¼Œæ•ˆç‡ä½ä¸‹ã€‚")])]),t._v(" "),a("h2",{attrs:{id:"semaphore-ä¿¡å·é‡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#semaphore-ä¿¡å·é‡"}},[t._v("#")]),t._v(" Semaphoreï¼ˆä¿¡å·é‡ï¼‰")]),t._v(" "),a("p",[a("code",[t._v("synchronized")]),t._v(" å’Œ "),a("code",[t._v("ReentrantLock")]),t._v(" éƒ½æ˜¯ä¸€æ¬¡åªå…è®¸ä¸€ä¸ªçº¿ç¨‹è®¿é—®æŸä¸ªèµ„æºï¼ŒSemaphore(ä¿¡å·é‡)å¯ä»¥æŒ‡å®šå¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®æŸä¸ªèµ„æºã€‚")]),t._v(" "),a("ol",[a("li",[t._v("Semaphore ä¸ CountDownLatch ä¸€æ ·ï¼Œä¹Ÿæ˜¯å…±äº«é”çš„ä¸€ç§å®ç°ã€‚å®ƒé»˜è®¤æ„é€  AQS çš„ state ä¸º permitsã€‚å½“æ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹æ•°é‡è¶…å‡º permitsï¼Œé‚£ä¹ˆå¤šä½™çš„çº¿ç¨‹å°†ä¼šè¢«æ”¾å…¥é˜»å¡é˜Ÿåˆ— Park,å¹¶è‡ªæ—‹åˆ¤æ–­ state æ˜¯å¦å¤§äº 0ã€‚")]),t._v(" "),a("li",[t._v("åªæœ‰å½“ state å¤§äº 0 çš„æ—¶å€™ï¼Œé˜»å¡çš„çº¿ç¨‹æ‰èƒ½ç»§ç»­æ‰§è¡Œ,æ­¤æ—¶å…ˆå‰æ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹ç»§ç»­æ‰§è¡Œ release() æ–¹æ³•ï¼Œrelease() æ–¹æ³•ä½¿å¾— state çš„å˜é‡ä¼šåŠ  1ï¼Œé‚£ä¹ˆè‡ªæ—‹çš„çº¿ç¨‹ä¾¿ä¼šåˆ¤æ–­æˆåŠŸã€‚")]),t._v(" "),a("li",[t._v("å¦‚æ­¤ï¼Œæ¯æ¬¡åªæœ‰æœ€å¤šä¸è¶…è¿‡ permits æ•°é‡çš„çº¿ç¨‹èƒ½è‡ªæ—‹æˆåŠŸï¼Œä¾¿é™åˆ¶äº†æ‰§è¡Œä»»åŠ¡çº¿ç¨‹çš„æ•°é‡ã€‚")])]),t._v(" "),a("h2",{attrs:{id:"countdownlatch-å€’è®¡æ—¶å™¨"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#countdownlatch-å€’è®¡æ—¶å™¨"}},[t._v("#")]),t._v(" CountDownLatch ï¼ˆå€’è®¡æ—¶å™¨ï¼‰")]),t._v(" "),a("p",[t._v("CountDownLatchå…è®¸ count ä¸ªçº¿ç¨‹å»é˜»å¡ç­‰å¾…å…¶ä»–çº¿ç¨‹ã€‚å®ç°æµç¨‹å¦‚ä¸‹ï¼š")]),t._v(" "),a("ol",[a("li",[t._v("CountDownLatch æ˜¯å…±äº«é”çš„ä¸€ç§å®ç°,å®ƒé»˜è®¤æ„é€  AQS çš„ state å€¼ä¸º countã€‚å½“çº¿ç¨‹ä½¿ç”¨ countDown() æ–¹æ³•æ—¶,å…¶å®ä½¿ç”¨äº†tryReleaseSharedæ–¹æ³•ä»¥ CAS çš„æ“ä½œæ¥å‡å°‘ state,ç›´è‡³ state ä¸º 0 ã€‚")]),t._v(" "),a("li",[t._v("å½“è°ƒç”¨ await() æ–¹æ³•çš„æ—¶å€™ï¼Œå¦‚æœ state ä¸ä¸º 0ï¼Œé‚£å°±è¯æ˜ä»»åŠ¡è¿˜æ²¡æœ‰æ‰§è¡Œå®Œæ¯•ï¼Œawait() æ–¹æ³•å°±ä¼šä¸€ç›´é˜»å¡ï¼Œä¹Ÿå°±æ˜¯è¯´ await() æ–¹æ³•ä¹‹åçš„è¯­å¥ä¸ä¼šè¢«æ‰§è¡Œã€‚")]),t._v(" "),a("li",[t._v("ç„¶åï¼ŒCountDownLatch ä¼šè‡ªæ—‹ CAS åˆ¤æ–­ state == 0ï¼Œå¦‚æœ state == 0 çš„è¯ï¼Œå°±ä¼šé‡Šæ”¾æ‰€æœ‰ç­‰å¾…çš„çº¿ç¨‹ï¼Œawait() æ–¹æ³•ä¹‹åçš„è¯­å¥å¾—åˆ°æ‰§è¡Œã€‚")])]),t._v(" "),a("p",[t._v("ä¸¤ç§å…¸å‹çš„ä½¿ç”¨åœºæ™¯ï¼š")]),t._v(" "),a("ol",[a("li",[t._v("æŸä¸€çº¿ç¨‹åœ¨å¼€å§‹è¿è¡Œå‰ç­‰å¾… n ä¸ªçº¿ç¨‹æ‰§è¡Œå®Œæ¯•\n"),a("ul",[a("li",[t._v("å°† CountDownLatch çš„è®¡æ•°å™¨åˆå§‹åŒ–ä¸º n ï¼ˆnew CountDownLatch(n)ï¼‰ï¼Œæ¯å½“ä¸€ä¸ªä»»åŠ¡çº¿ç¨‹æ‰§è¡Œå®Œæ¯•ï¼Œå°±å°†è®¡æ•°å™¨å‡ 1 ï¼ˆcountdownlatch.countDown()ï¼‰ï¼Œå½“è®¡æ•°å™¨çš„å€¼å˜ä¸º 0 æ—¶ï¼Œåœ¨ CountDownLatch ä¸Š await() çš„çº¿ç¨‹å°±ä¼šè¢«å”¤é†’ã€‚")]),t._v(" "),a("li",[t._v("ä¸€ä¸ªå…¸å‹åº”ç”¨åœºæ™¯å°±æ˜¯å¯åŠ¨ä¸€ä¸ªæœåŠ¡æ—¶ï¼Œä¸»çº¿ç¨‹éœ€è¦ç­‰å¾…å¤šä¸ªç»„ä»¶åŠ è½½å®Œæ¯•ï¼Œä¹‹åå†ç»§ç»­æ‰§è¡Œã€‚")])])]),t._v(" "),a("li",[t._v("å®ç°å¤šä¸ªçº¿ç¨‹å¼€å§‹æ‰§è¡Œä»»åŠ¡çš„æœ€å¤§"),a("strong",[t._v("å¹¶è¡Œæ€§")]),t._v("ã€‚\n"),a("ul",[a("li",[t._v("åˆå§‹åŒ–ä¸€ä¸ªå…±äº«çš„ CountDownLatch å¯¹è±¡ï¼Œå°†å…¶è®¡æ•°å™¨åˆå§‹åŒ–ä¸º 1 ï¼ˆnew CountDownLatch(1)ï¼‰ï¼Œå¤šä¸ªçº¿ç¨‹åœ¨å¼€å§‹æ‰§è¡Œä»»åŠ¡å‰é¦–å…ˆ coundownlatch.await()ï¼Œå½“ä¸»çº¿ç¨‹è°ƒç”¨ countDown() æ—¶ï¼Œè®¡æ•°å™¨å˜ä¸º 0ï¼Œå¤šä¸ªçº¿ç¨‹åŒæ—¶è¢«å”¤é†’ã€‚")])])])]),t._v(" "),a("h2",{attrs:{id:"cyclicbarrier-å¾ªç¯æ …æ "}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cyclicbarrier-å¾ªç¯æ …æ "}},[t._v("#")]),t._v(" CyclicBarrierï¼ˆå¾ªç¯æ …æ ï¼‰")]),t._v(" "),a("p",[t._v("å®ƒæ˜¯ä¸€ä¸ªåŒæ­¥çš„å·¥å…·ï¼Œèƒ½å¤Ÿå…è®¸ä¸€ç»„çº¿ç¨‹å»äº’ç›¸ç­‰å¾…ç›´åˆ°éƒ½åˆ°è¾¾äº†å±éšœï¼ŒCyclicBarrierå¯¹äºæ¶‰åŠåˆ°å›ºå®šå¤§å°çš„çº¿ç¨‹æ˜¯éå¸¸æœ‰ç”¨çš„ï¼Œçº¿ç¨‹ä»¬å¿…é¡»ç›¸äº’ç­‰å¾…ã€‚è¯¥å±éšœç§°ä¹‹ä¸ºå¾ªç¯å±éšœï¼Œæ˜¯å› ä¸ºå½“ç­‰å¾…å±éšœçš„çº¿ç¨‹è¢«é‡Šæ”¾ä¹‹åï¼Œè¯¥å±éšœèƒ½å¾ªç¯ä½¿ç”¨ã€‚")]),t._v(" "),a("blockquote",[a("p",[t._v("CountDownLatch çš„å®ç°æ˜¯åŸºäº AQS çš„ï¼Œè€Œ CycliBarrier æ˜¯åŸºäº ReentrantLock(ReentrantLock ä¹Ÿå±äº AQS åŒæ­¥å™¨)å’Œ Condition çš„ã€‚")])]),t._v(" "),a("h2",{attrs:{id:"reentrantlock-å¯é‡å…¥é”"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#reentrantlock-å¯é‡å…¥é”"}},[t._v("#")]),t._v(" ReentrantLockï¼ˆå¯é‡å…¥é”ï¼‰")]),t._v(" "),a("h2",{attrs:{id:"reentrantreadwritelock-å¯é‡å…¥è¯»å†™é”"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#reentrantreadwritelock-å¯é‡å…¥è¯»å†™é”"}},[t._v("#")]),t._v(" ReentrantReadWriteLockï¼ˆå¯é‡å…¥è¯»å†™é”ï¼‰")]),t._v(" "),a("h2",{attrs:{id:"å‚è€ƒæ–‡æ¡£"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å‚è€ƒæ–‡æ¡£"}},[t._v("#")]),t._v(" å‚è€ƒæ–‡æ¡£")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://juejin.cn/post/6844903732061159437",target:"_blank",rel:"noopener noreferrer"}},[t._v("å¤§ç™½è¯èŠèŠJavaå¹¶å‘é¢è¯•é—®é¢˜ä¹‹è°ˆè°ˆä½ å¯¹AQSçš„ç†è§£ï¼Ÿã€çŸ³æ‰çš„æ¶æ„ç¬”è®°ã€‘"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=n.exports}}]);