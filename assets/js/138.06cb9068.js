(window.webpackJsonp=window.webpackJsonp||[]).push([[138],{406:function(v,_,e){"use strict";e.r(_);var t=e(10),o=Object(t.a)({},(function(){var v=this,_=v._self._c;return _("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[_("h1",{attrs:{id:"基础架构"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#基础架构"}},[v._v("#")]),v._v(" 基础架构")]),v._v(" "),_("p",[_("code",[v._v("MySQL")]),v._v(" 的基本架构示意图( 🎏 网络图片，学习使用，侵权删除)\n"),_("img",{attrs:{src:"/img/mysql/MySQL-Infrastructure.png",alt:"MySQL-Infrastructure.png"}})]),v._v(" "),_("p",[v._v("大体来说"),_("code",[v._v("MySQL")]),v._v("分为"),_("code",[v._v("Server")]),v._v("层和"),_("strong",[v._v("储存引擎层")]),v._v("两部分。")]),v._v(" "),_("ul",[_("li",[_("code",[v._v("Server")]),v._v("层包括连接器、查询缓存、分析器、优化器、执行器等，涵盖"),_("code",[v._v("MySQL")]),v._v("的大多数核心服务功能，以及所有的内置函数(如日期、时间、数学和加密函数等)，所有跨存储引擎的功能都在这一层实现，比如存储过程、触发器、视图等。")]),v._v(" "),_("li",[_("strong",[v._v("存储引擎层负责数据的存储和提取")]),v._v("。其架构模式是插件式的，支持"),_("code",[v._v("InnoDB")]),v._v("、"),_("code",[v._v("MyISAM")]),v._v("、"),_("code",[v._v("Memory")]),v._v("等多个存储引擎。现在最常用的存储引擎是"),_("code",[v._v("InnoDB")]),v._v("，它从"),_("code",[v._v("MySQL 5.5.5")]),v._v("版本开始成为了默认存储引擎。")])]),v._v(" "),_("h2",{attrs:{id:"连接器"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#连接器"}},[v._v("#")]),v._v(" 连接器")]),v._v(" "),_("p",[v._v("连接器负责跟客户端建立连接、获取权限、维持和管理连接")]),v._v(" "),_("h2",{attrs:{id:"查询缓存"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#查询缓存"}},[v._v("#")]),v._v(" 查询缓存")]),v._v(" "),_("p",[_("code",[v._v("MySQL")]),v._v("拿到一个请求后，会先去查询缓存看看、之前是不是执行过这条语句。之前执行过的语句可能会以"),_("code",[v._v("key-value")]),v._v("对的形式被直接放在内存。如存在直接返回结果，不存在则查询，并将结果记入缓存。\n对于更新压力大的数据库来说，查询缓存的命中率会非常低。")]),v._v(" "),_("blockquote",[_("p",[v._v("需要注意的是，"),_("code",[v._v("MySQL 8.0")]),v._v("版本直接将查询缓存的整块功能删掉了，也就是说"),_("code",[v._v("8.0")]),v._v("已经没有缓存了。")])]),v._v(" "),_("h2",{attrs:{id:"分析器"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#分析器"}},[v._v("#")]),v._v(" 分析器")]),v._v(" "),_("p",[v._v("对"),_("code",[v._v("SQL")]),v._v("语句做词法分析、语法分析，如果你的"),_("code",[v._v("SQL")]),v._v("语句不对，就会收到"),_("code",[v._v("You have an error in your SQL syntax")]),v._v("的错误提醒。")]),v._v(" "),_("h2",{attrs:{id:"优化器"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#优化器"}},[v._v("#")]),v._v(" 优化器")]),v._v(" "),_("p",[v._v("优化器是在表里面有多个索引的时候，决定使用哪个索引；或者在一个语句有多表关联（"),_("code",[v._v("join")]),v._v("）的时候，决定各个表的连接顺序。")]),v._v(" "),_("h2",{attrs:{id:"执行器"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#执行器"}},[v._v("#")]),v._v(" 执行器")]),v._v(" "),_("p",[v._v("根据表的引擎定义，去使用这个引擎提供的接口。")]),v._v(" "),_("h2",{attrs:{id:"innodb存储引擎架构图"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#innodb存储引擎架构图"}},[v._v("#")]),v._v(" InnoDB存储引擎架构图")]),v._v(" "),_("p",[_("img",{attrs:{src:"/img/mysql/innodb-architecture.png",alt:"innodb-architecture"}})]),v._v(" "),_("p",[v._v("从这张图可以看到，"),_("code",[v._v("InnoDB")]),v._v("存储结构主要包括两部分："),_("strong",[v._v("逻辑存储结构")]),v._v("和"),_("strong",[v._v("物理存储结构")]),v._v("。")]),v._v(" "),_("p",[v._v("逻辑上是由表空间"),_("code",[v._v("tablespace")]),v._v(" —>  段"),_("code",[v._v("segment")]),v._v("或者"),_("code",[v._v("inode")]),v._v(" —> 区"),_("code",[v._v("Extent")]),v._v(" ——>数据页"),_("code",[v._v("Page")]),v._v("构成，"),_("code",[v._v("Innodb")]),v._v("逻辑管理单位是"),_("code",[v._v("segment")]),v._v("，\n空间分配的最小单位是"),_("code",[v._v("extent")]),v._v("，每个"),_("code",[v._v("segment")]),v._v("都会从表空间"),_("code",[v._v("FREE_PAGE")]),v._v("中分配"),_("code",[v._v("32")]),v._v("个"),_("code",[v._v("page")]),v._v("，当这"),_("code",[v._v("32")]),v._v("个"),_("code",[v._v("page")]),v._v("不够用时，会按照以下原则进行扩展：\n如果当前小于"),_("code",[v._v("1")]),v._v("个"),_("code",[v._v("extent")]),v._v("，则扩展到"),_("code",[v._v("1")]),v._v("个"),_("code",[v._v("extent")]),v._v("；当表空间小于"),_("code",[v._v("32MB")]),v._v("时，每次扩展一个"),_("code",[v._v("extent")]),v._v("；表空间大于"),_("code",[v._v("32MB")]),v._v("，每次扩展"),_("code",[v._v("4")]),v._v("个"),_("code",[v._v("extent")]),v._v("。")]),v._v(" "),_("p",[v._v("物理上主要由系统用户数据文件，日志文件组成，数据文件主要存储"),_("code",[v._v("MySQL")]),v._v("字典数据和用户数据，日志文件记录的是"),_("code",[v._v("data page")]),v._v("的变更记录，用于"),_("code",[v._v("MySQL Crash")]),v._v("时的恢复。")])])}),[],!1,null,null,null);_.default=o.exports}}]);